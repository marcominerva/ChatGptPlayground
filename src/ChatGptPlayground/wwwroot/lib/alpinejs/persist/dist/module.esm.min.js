function m(t){let a=()=>{let r,l;try{l=localStorage}catch(i){console.error(i),console.warn("Alpine: $persist is using temporary storage since localStorage is unavailable.");let e=new Map;l={getItem:e.get.bind(e),setItem:e.set.bind(e)}}return t.interceptor((i,e,o,s,d)=>{let n=r||`_x_${s}`,u=g(n,l)?f(n,l):i;return o(u),t.effect(()=>{let c=e();p(n,c,l),o(c)}),u},i=>{i.as=e=>(r=e,i),i.using=e=>(l=e,i)})};Object.defineProperty(t,"$persist",{get:()=>a()}),t.magic("persist",a),t.persist=(r,{get:l,set:i},e=localStorage)=>{let o=g(r,e)?f(r,e):l();i(o),t.effect(()=>{let s=l();p(r,s,e),i(s)})}}function g(t,a){return a.getItem(t)!==null}function f(t,a){let r=a.getItem(t,a);if(r!==void 0)return JSON.parse(r)}function p(t,a,r){r.setItem(t,JSON.stringify(a))}var b=m;export{b as default,m as persist};
